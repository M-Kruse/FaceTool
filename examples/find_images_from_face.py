import sys
import dlib
sys.path.insert(1, '../')
from FaceTool import FaceTool 

shape_model = "../models/shape_predictor_5_face_landmarks.dat"
face_model = "../models/dlib_face_recognition_resnet_model_v1.dat"

test_face_descriptor = [-0.044745635241270065, 0.01035443227738142, -0.00460539385676384, -0.08217760920524597, -0.03258712962269783, -0.020631093531847, 0.0022960081696510315, -0.06402505934238434, 0.18778656423091888, -0.09386634826660156, 0.20236831903457642, -0.011630808934569359, -0.2571008801460266, -0.04958845674991608, 0.020140022039413452, 0.12279694527387619, -0.19913049042224884, -0.05811778083443642, -0.08832401037216187, -0.06485656648874283, -0.03650742396712303, -0.036517851054668427, 0.15630319714546204, -0.023732803761959076, -0.1473870575428009, -0.31061848998069763, -0.08482909202575684, -0.1370134949684143, 0.10744239389896393, -0.047413088381290436, -0.0018033008091151714, 0.005468042567372322, -0.21860912442207336, -0.1007959395647049, 0.0319112092256546, 0.0734613686800003, -0.1445590704679489, -0.0945824384689331, 0.28418004512786865, 0.1098339632153511, -0.13083778321743011, -0.05747716501355171, 0.0025217868387699127, 0.22496142983436584, 0.20225512981414795, 0.021667322143912315, 0.05847971513867378, -0.15387889742851257, 0.04275946319103241, -0.22362937033176422, 0.09122353792190552, 0.10302285104990005, 0.10890188813209534, 0.08542187511920929, 0.10583142936229706, -0.10022411495447159, 0.08059082925319672, 0.12298879027366638, -0.18112044036388397, 0.031302809715270996, 0.10951820015907288, -0.014687017537653446, -0.029874064028263092, -0.03469422832131386, 0.23967324197292328, 0.08337098360061646, -0.0920628011226654, -0.05646560341119766, 0.20338010787963867, -0.07576803117990494, -0.06699594855308533, 0.017077339813113213, -0.05739456042647362, -0.15776750445365906, -0.2926930785179138, -0.023512698709964752, 0.3242782652378082, 0.18809106945991516, -0.0915643498301506, 0.024044545367360115, -0.12125974893569946, -0.06937287747859955, 0.04266565293073654, 0.09261473268270493, -0.13645857572555542, 0.018085476011037827, 0.026453334838151932, 0.055625978857278824, 0.09034675359725952, -0.04320713132619858, -0.04046676307916641, 0.1218779981136322, -0.028077326714992523, 0.023454759269952774, 0.0517791286110878, -0.019586920738220215, -0.14952509105205536, 0.003880666568875313, -0.1622397005558014, -0.08872722089290619, 0.07627071440219879, -0.1155235767364502, 0.10522227734327316, 0.11441468447446823, -0.22370630502700806, 0.11968065798282623, 0.006621243432164192, -0.1398393213748932, 0.0786500796675682, 0.005100242793560028, -0.07128290086984634, -0.003295253962278366, 0.12535810470581055, -0.2849559783935547, 0.22079867124557495, 0.2124767005443573, 0.010037926957011223, 0.13392917811870575, 0.13022303581237793, 0.07510345429182053, -0.032995715737342834, 0.03506522253155708, -0.17212478816509247, -0.054871104657649994, -0.02183101512491703, 0.08274289965629578, 0.12106087803840637, 0.04140873998403549]

ft = FaceTool(shape_model, face_model, "FACESLURP", ["127.0.0.1"])
print("[INFO] Searching for face descriptor:\n\n {} \n\n".format(test_face_descriptor))
results = ft.db_search_for_face(test_face_descriptor)
if results:
	for row in results:
	    ret, source = ft.db_search_source_img_by_uuid(row['source_img_uuid'])
	    print("Face found in image: {0}".format(source[0]['storage_path']))
else:
	print("[INFO] Face descriptor not found in database...")
